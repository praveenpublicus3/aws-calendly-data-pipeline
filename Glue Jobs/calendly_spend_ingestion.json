{
	"jobConfig": {
		"name": "calendly_spend_ingestion",
		"description": "",
		"role": "arn:aws:iam::647132523501:role/glue-s3-role-calendly",
		"command": "glueetl",
		"version": "5.0",
		"runtime": null,
		"workerType": "G.1X",
		"numberOfWorkers": 10,
		"maxCapacity": 10,
		"jobRunQueuingEnabled": false,
		"maxRetries": 0,
		"timeout": 480,
		"maxConcurrentRuns": 1,
		"security": "none",
		"scriptName": "calendly_spend_ingestion.py",
		"scriptLocation": "s3://aws-glue-assets-647132523501-us-east-1/scripts/",
		"language": "python-3",
		"spark": true,
		"sparkConfiguration": "standard",
		"jobParameters": [],
		"tags": [],
		"jobMode": "DEVELOPER_MODE",
		"createdOn": "2025-10-30T13:16:55.499Z",
		"developerMode": true,
		"connectionsList": [],
		"temporaryDirectory": "s3://aws-glue-assets-647132523501-us-east-1/temporary/",
		"glueHiveMetastore": true,
		"etlAutoTuning": true,
		"metrics": true,
		"observabilityMetrics": true,
		"bookmark": "job-bookmark-disable",
		"sparkPath": "s3://aws-glue-assets-647132523501-us-east-1/sparkHistoryLogs/",
		"flexExecution": false,
		"minFlexWorkers": null,
		"maintenanceWindow": null
	},
	"hasBeenSaved": false,
	"usageProfileName": null,
	"script": "import boto3\r\nimport requests\r\nimport json\r\nfrom datetime import date, timedelta\r\n\r\ns3 = boto3.client('s3')\r\nbucket = \"marketing-calendly-project\"\r\nprefix = \"spend/\"\r\n\r\n# Yesterday’s date (Day-1)\r\ntoday = date.today()\r\nfile_date = (today - timedelta(days=1)).strftime(\"%Y-%m-%d\")\r\n\r\n# Public JSON file URL\r\nurl = f\"https://dea-data-bucket.s3.us-east-1.amazonaws.com/calendly_spend_data/spend_data_{file_date}.json\"\r\nresponse = requests.get(url)\r\ndata = response.json()\r\n\r\n# Upload file to your S3 bucket\r\ns3.put_object(\r\n    Bucket=bucket,\r\n    Key=f\"{prefix}spend_data_{file_date}.json\",\r\n    Body=json.dumps(data)\r\n)\r\n\r\nprint(\"✅ Spend data file successfully copied to S3.\")\r\n"
}